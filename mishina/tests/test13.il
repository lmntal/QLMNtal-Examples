// g{+L1,+L2,+L3}, g{+L4,+L5,+L6},
// r{+L1,+L4}, r{+L2,+L5}, r{+L3,+L6}.
//
// M<1,>g{N<1,>+X},N<1,>r{M<1,>+X}
// :- r{+X},g{+X}.

Compiled Ruleset @602 
Compiled Rule 
	--atommatch:
	--memmatch:
		spec           [1, 1]
		jump           [L106, [0], [], []]
	--guard:L106:
		spec           [1, 1]
		jump           [L107, [0], [], []]
	--body:L107:
		spec           [1, 103]
		commit         ["_init", 0]
		newmem       [1, 0, 0]
		setmemname     [1, "g"]
		newmem       [2, 0, 0]
		setmemname     [2, "g"]
		newmem       [3, 0, 0]
		setmemname     [3, "r"]
		newmem       [4, 0, 0]
		setmemname     [4, "r"]
		newmem       [5, 0, 0]
		setmemname     [5, "r"]
		loadruleset    [0, @601]
		newatom      [6, 1, '+'_1]
		newatom      [7, 1, '+'_1]
		newatom      [8, 1, '+'_1]
		newatom      [9, 1, $in_2]
		newatom      [10, 1, $in_2]
		newatom      [11, 1, $in_2]
		newatom      [12, 2, '+'_1]
		newatom      [13, 2, '+'_1]
		newatom      [14, 2, '+'_1]
		newatom      [15, 2, $in_2]
		newatom      [16, 2, $in_2]
		newatom      [17, 2, $in_2]
		newatom      [18, 3, '+'_1]
		newatom      [19, 3, '+'_1]
		newatom      [20, 3, $in_2]
		newatom      [21, 3, $in_2]
		newatom      [22, 4, '+'_1]
		newatom      [23, 4, '+'_1]
		newatom      [24, 4, $in_2]
		newatom      [25, 4, $in_2]
		newatom      [26, 5, '+'_1]
		newatom      [27, 5, '+'_1]
		newatom      [28, 5, $in_2]
		newatom      [29, 5, $in_2]
		newatom      [30, 0, $out_2]
		newatom      [31, 0, $out_2]
		newatom      [32, 0, $out_2]
		newatom      [33, 0, $out_2]
		newatom      [34, 0, $out_2]
		newatom      [35, 0, $out_2]
		newatom      [36, 0, $out_2]
		newatom      [37, 0, $out_2]
		newatom      [38, 0, $out_2]
		newatom      [39, 0, $out_2]
		newatom      [40, 0, $out_2]
		newatom      [41, 0, $out_2]
		alloclink    [42, 6, 0]
		alloclink    [43, 7, 0]
		alloclink    [44, 8, 0]
		alloclink    [45, 9, 0]
		alloclink    [46, 9, 1]
		alloclink    [47, 10, 0]
		alloclink    [48, 10, 1]
		alloclink    [49, 11, 0]
		alloclink    [50, 11, 1]
		alloclink    [51, 12, 0]
		alloclink    [52, 13, 0]
		alloclink    [53, 14, 0]
		alloclink    [54, 15, 0]
		alloclink    [55, 15, 1]
		alloclink    [56, 16, 0]
		alloclink    [57, 16, 1]
		alloclink    [58, 17, 0]
		alloclink    [59, 17, 1]
		alloclink    [60, 18, 0]
		alloclink    [61, 19, 0]
		alloclink    [62, 20, 0]
		alloclink    [63, 20, 1]
		alloclink    [64, 21, 0]
		alloclink    [65, 21, 1]
		alloclink    [66, 22, 0]
		alloclink    [67, 23, 0]
		alloclink    [68, 24, 0]
		alloclink    [69, 24, 1]
		alloclink    [70, 25, 0]
		alloclink    [71, 25, 1]
		alloclink    [72, 26, 0]
		alloclink    [73, 27, 0]
		alloclink    [74, 28, 0]
		alloclink    [75, 28, 1]
		alloclink    [76, 29, 0]
		alloclink    [77, 29, 1]
		alloclink    [78, 30, 0]
		alloclink    [79, 30, 1]
		alloclink    [80, 31, 0]
		alloclink    [81, 31, 1]
		alloclink    [82, 32, 0]
		alloclink    [83, 32, 1]
		alloclink    [84, 33, 0]
		alloclink    [85, 33, 1]
		alloclink    [86, 34, 0]
		alloclink    [87, 34, 1]
		alloclink    [88, 35, 0]
		alloclink    [89, 35, 1]
		alloclink    [90, 36, 0]
		alloclink    [91, 36, 1]
		alloclink    [92, 37, 0]
		alloclink    [93, 37, 1]
		alloclink    [94, 38, 0]
		alloclink    [95, 38, 1]
		alloclink    [96, 39, 0]
		alloclink    [97, 39, 1]
		alloclink    [98, 40, 0]
		alloclink    [99, 40, 1]
		alloclink    [100, 41, 0]
		alloclink    [101, 41, 1]
		unifylinks     [42, 46, 1]
		unifylinks     [43, 48, 1]
		unifylinks     [44, 50, 1]
		unifylinks     [51, 55, 2]
		unifylinks     [52, 57, 2]
		unifylinks     [53, 59, 2]
		unifylinks     [60, 63, 3]
		unifylinks     [61, 65, 3]
		unifylinks     [66, 69, 4]
		unifylinks     [67, 71, 4]
		unifylinks     [72, 75, 5]
		unifylinks     [73, 77, 5]
		unifylinks     [78, 45, 0]
		unifylinks     [79, 91, 0]
		unifylinks     [80, 47, 0]
		unifylinks     [81, 95, 0]
		unifylinks     [82, 49, 0]
		unifylinks     [83, 99, 0]
		unifylinks     [84, 54, 0]
		unifylinks     [85, 93, 0]
		unifylinks     [86, 56, 0]
		unifylinks     [87, 97, 0]
		unifylinks     [88, 58, 0]
		unifylinks     [89, 101, 0]
		unifylinks     [90, 62, 0]
		unifylinks     [92, 64, 0]
		unifylinks     [94, 68, 0]
		unifylinks     [96, 70, 0]
		unifylinks     [98, 74, 0]
		unifylinks     [100, 76, 0]
		newatom        [102, 0, 'token'_0]
		proceed        []


Compiled Ruleset @601 
Compiled Rule 
	--atommatch:
	--memmatch:
		spec           [1, 200]
		findatom       [199, 0, 'token'_0]
		// match green node
		anymem         [1, 0, 0, "g"]
		norules        [1]
		// match edge from green to red
		findatom       [2, 1, '+'_1]
		deref          [3, 2, 0, 1]
		func           [3, $in_2]
		deref          [4, 3, 0, 0]
		func           [4, $out_2]
		deref          [5, 4, 1, 1]
		func           [5, $out_2]
		deref          [6, 5, 0, 0]
		func           [6, $in_2]
		deref          [7, 6, 1, 0]
		func           [7, '+'_1]
		// match red node
		lockmem        [8, 6, "r"]
		norules        [8]
		branch         [[
			// match edge from green to red
			findatom       [9, 1, '+'_1]
			neqatom        [9, 2]
			deref          [10, 9, 0, 1]
			func           [10, $in_2]
			deref          [11, 10, 0, 0]
			func           [11, $out_2]
			deref          [12, 11, 1, 1]
			func           [12, $out_2]
			deref          [13, 12, 0, 0]
			func           [13, $in_2]
			deref          [14, 13, 1, 0]
			func           [14, '+'_1]
			// match red node
			lockmem        [15, 13, "r"]
			branch         [[
				// match edge from red to green
				findatom       [16, 15, '+'_1]
				neqatom        [16, 14]
				deref          [17, 16, 0, 1]
				func           [17, $in_2]
				deref          [18, 17, 0, 0]
				func           [18, $out_2]
				deref          [19, 18, 1, 1]
				func           [19, $out_2]
				deref          [20, 19, 0, 0]
				func           [20, $in_2]
				deref          [21, 20, 1, 0]
				func           [21, '+'_1]
				pushmap        [22, [16,17,18,19,20,21]]
				failreturn     []
			]]
			pickmaps       [23, 22, -1]
			not            [[
				anyatom        [24, 15]
				neqatom        [24, 14]
				mapneqatom     [24, [23, 16]]
				proceed        []
			]]
			pushmap        [25, [9,10,11,12,13,14,15,23]]
			failreturn     []
		]]
		pickmaps       [26, 25, -1]
		not            [[
			anyatom        [27, 1]
			neqatom        [27, 2]
			mapneqatom     [27, [26, 9]]
			proceed        []
		]]
		// extract overlapping edge
		pickmaps       [55, 55, 0]
		loop           [[
			popmap         [26]
			loop           [[
				popmap         [23]
				pushmap        [55, [16,17,18,19,20,21]]
				proceed        []
			]]
			proceed        []
		]]
		branch         [[
			// match edge from red to green
			findatom       [36, 8, '+'_1]
			neqatom        [36, 7]
			deref          [37, 36, 0, 1]
			func           [37, $in_2]
			deref          [38, 37, 0, 0]
			func           [38, $out_2]
			deref          [39, 38, 1, 1]
			func           [39, $out_2]
			deref          [40, 39, 0, 0]
			func           [40, $in_2]
			deref          [41, 40, 1, 0]
			func           [41, '+'_1]
			// match green node
			lockmem        [42, 40, "g"]
			branch         [[
				// match edge from green to red
				findatom       [43, 42, '+'_1]
				neqatom        [43, 41]
				deref          [44, 43, 0, 1]
				func           [44, $in_2]
				deref          [45,44, 0, 0]
				func           [45, $out_2]
				deref          [46, 45, 1, 1]
				func           [46, $out_2]
				deref          [47, 46, 0, 0]
				func           [47, $in_2]
				deref          [48, 47, 1, 0]
				func           [48, '+'_1]
				pushmap        [49, [43,44,45,46,47,48]]
				failreturn     []
			]]
			pickmaps       [50, 49, -1]
			not            [[
				anyatom        [51, 42]
				neqatom        [51, 41]
				mapneqatom     [51, [50, 43]]
				proceed        []
			]]
			pushmap        [52, [36,37,38,39,40,41,42,50]]
			failreturn     []
		]]
		pickmaps       [53, 52, -1]
		not            [[
			anyatom        [54, 8]
			neqatom        [54, 7]
			mapneqatom     [54, [53, 36]]
			proceed        []
		]]
		// extract overlapping edge
		pickmaps       [56, 56, 0]
		loop           [[
			popmap         [53]
			loop           [[
				popmap         [50]
				pushmap        [56, [43,44,45,46,47,48]]
				proceed        []
			]]
			proceed        []
		]]
		// check overlapping edge
        eqmaps         [55, 56]
		commit         ["_gXpr", 0]
		removeatom     [199, 0]
		// create red node
        newmem         [101, 0, 0]
        setmemname     [101, "rr"]
		// create green node
        newmem         [105, 0, 0]
        setmemname     [105, "gg"]
		// create inward red edge
        newatom        [102, 101, '+'_1]
        newatom        [103, 101, $in_2]
        newatom        [104, 0, $out_2]
		newlink        [102, 0, 103, 1, 101]
		newlink        [103, 0, 104, 0, 101]
		// create inward green edge
        newatom        [106, 105, '+'_1]
        newatom        [107, 105, $in_2]
        newatom        [108, 0, $out_2]
		newlink        [106, 0, 107, 1, 105]
		newlink        [107, 0, 108, 0, 105]
		newlink        [104, 1, 108, 1, 0]
		// remove inward green edge
        removeatom     [2, 1]
        removeatom     [3, 1]
        removeatom     [4, 0]
		// remove inward red edge
        removeatom     [5, 0]
        removeatom     [6, 8]
        removeatom     [7, 8]
		loop           [[
            popmap         [26]
			// remove edge from green to red
        	removeatom     [9, 1]
        	removeatom     [10, 1]
        	removeatom     [11, 0]
        	removeatom     [12, 0]
        	removeatom     [13, 15]
        	removeatom     [14, 15]
			loop           [[
				popmap         [23]
				// remove edge from red to middle
				removeatom     [16, 15]
				removeatom     [17, 15]
				removeatom     [18, 0]
				proceed        []
			]]
			// remove red node
			removemem      [15, 0]
			proceed        []
		]]
		// remove green node
        removemem      [1, 0]
		loop           [[
            popmap         [53]
			// remove edge from red to green
        	removeatom     [36, 8]
        	removeatom     [37, 8]
        	removeatom     [38, 0]
        	removeatom     [39, 0]
        	removeatom     [40, 42]
        	removeatom     [41, 42]
			loop           [[
				popmap         [50]
				// remove edge green to red
				removeatom     [43, 42]
				removeatom     [44, 42]
				removeatom     [45, 0]
				proceed        []
			]]
			// remove green node
        	removemem      [42, 0]
			proceed        []
		]]
		// remove red node
        removemem      [8, 0]
		proceed        []



